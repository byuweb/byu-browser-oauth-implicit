const LEVEL_TRACE={priority:0,name:"trace",run:handleTrace},LEVEL_DEBUG={priority:1,name:"debug",run:handleDebug},LEVEL_INFO={priority:10,name:"info",run:handleInfo},LEVEL_ERROR={priority:100,name:"error",run:handleError},ALL_LEVELS=[LEVEL_TRACE,LEVEL_DEBUG,LEVEL_INFO,LEVEL_ERROR],DEFAULT_LEVEL=LEVEL_ERROR;function debug(...a){log(LEVEL_DEBUG,...a)}function info(...a){log(LEVEL_INFO,...a)}function error(...a){log(LEVEL_ERROR,...a)}function debugf(a,...b){logf(LEVEL_DEBUG,a,...b)}function infof(a,...b){logf(LEVEL_INFO,a,...b)}function logf(a,b,...c){shouldLog(a)&&a.run(`[byu-browser-oauth-implicit] [${a.name}] (${getFormattedTime()}) ${b}`,...c)}function log(a,...b){shouldLog(a)&&a.run("[byu-browser-oauth-implicit]",`[${a.name}]`,`(${getFormattedTime()})`,...b)}function getFormattedTime(){const a=new Date,b=(a.getHours()+"").padStart(2,"0"),c=(a.getMinutes()+"").padStart(2,"0"),d=(a.getSeconds()+"").padStart(2,"0"),e=(a.getMilliseconds()+"").padStart(3,"0");return`${b}:${c}:${d},${e}${formatTimezone(a)}`}function formatTimezone(a){const b=a.getTimezoneOffset();if(0===b)return"Z";const c=Math.abs(b),d=Math.floor(c/60),e=(d+"").padStart(2,"0"),f=0<=b?"+":"-",g=(c%60+"").padStart(2,"0");return`${f}${e}${g}`}function shouldLog(a){return a.priority>=currentLevel().priority}function currentLevel(){const a=levelAttr()||levelGlobalVar();if(!a)return DEFAULT_LEVEL;const b=a.toLowerCase();return ALL_LEVELS.find(function(a){return a.name===b})||DEFAULT_LEVEL}function levelAttr(){return document.documentElement.getAttribute("byu-oauth-logging")}function levelGlobalVar(){const a=window.byuOAuth||{};return a.logging}function handleTrace(...a){console.trace?console.trace(...a):console.log(...a)}function handleDebug(...a){console.log(...a)}function handleInfo(...a){console.info?console.info(...a):console.log(...a)}function handleError(...a){console.error?console.error(...a):console.log(...a)}const EVENT_PREFIX="byu-browser-oauth",EVENT_STATE_CHANGE=`${"byu-browser-oauth"}-state-changed`,EVENT_LOGIN_REQUESTED=`${"byu-browser-oauth"}-login-requested`,EVENT_LOGOUT_REQUESTED=`${"byu-browser-oauth"}-logout-requested`,EVENT_REFRESH_REQUESTED=`${"byu-browser-oauth"}-refresh-requested`,EVENT_CURRENT_INFO_REQUESTED=`${"byu-browser-oauth"}-current-info-requested`,STATE_INDETERMINATE="indeterminate",STATE_UNAUTHENTICATED="unauthenticated",STATE_AUTHENTICATED="authenticated",STATE_AUTHENTICATING="authenticating",STATE_REFRESHING="refreshing",STATE_EXPIRED="expired",STATE_ERROR="error";var commonjsGlobal="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis;function unwrapExports(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a["default"]:a}function createCommonjsModule(a,b){return b={exports:{}},a(b,b.exports),b.exports}/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */ /**
 * Module exports.
 * @public
 */var parse_1=parse,serialize_1=serialize,decode=decodeURIComponent,encode=encodeURIComponent,pairSplitRegExp=/; */,fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;/**
 * Parse a cookie header.
 *
 * Parse the given cookie header string into an object
 * The object has the various cookies as keys(names) => values
 *
 * @param {string} str
 * @param {object} [options]
 * @return {object}
 * @public
 */function parse(a,b){if("string"!=typeof a)throw new TypeError("argument str must be a string");for(var c={},d=b||{},e=a.split(pairSplitRegExp),f=d.decode||decode,g=0;g<e.length;g++){var h=e[g],j=h.indexOf("=");// skip things that don't look like key=value
if(!(0>j)){var k=h.substr(0,j).trim(),l=h.substr(++j,h.length).trim();"\""==l[0]&&(l=l.slice(1,-1)),null==c[k]&&(c[k]=tryDecode(l,f))}}return c}/**
 * Serialize data into a cookie header.
 *
 * Serialize the a name value pair into a cookie string suitable for
 * http headers. An optional options object specified cookie parameters.
 *
 * serialize('foo', 'bar', { httpOnly: true })
 *   => "foo=bar; httpOnly"
 *
 * @param {string} name
 * @param {string} val
 * @param {object} [options]
 * @return {string}
 * @public
 */function serialize(a,b,c){var d=Math.floor,e=c||{},f=e.encode||encode;if("function"!=typeof f)throw new TypeError("option encode is invalid");if(!fieldContentRegExp.test(a))throw new TypeError("argument name is invalid");var g=f(b);if(g&&!fieldContentRegExp.test(g))throw new TypeError("argument val is invalid");var h=a+"="+g;if(null!=e.maxAge){var i=e.maxAge-0;if(isNaN(i))throw new Error("maxAge should be a Number");h+="; Max-Age="+d(i)}if(e.domain){if(!fieldContentRegExp.test(e.domain))throw new TypeError("option domain is invalid");h+="; Domain="+e.domain}if(e.path){if(!fieldContentRegExp.test(e.path))throw new TypeError("option path is invalid");h+="; Path="+e.path}if(e.expires){if("function"!=typeof e.expires.toUTCString)throw new TypeError("option expires is invalid");h+="; Expires="+e.expires.toUTCString()}if(e.httpOnly&&(h+="; HttpOnly"),e.secure&&(h+="; Secure"),e.sameSite){var j="string"==typeof e.sameSite?e.sameSite.toLowerCase():e.sameSite;switch(j){case!0:h+="; SameSite=Strict";break;case"lax":h+="; SameSite=Lax";break;case"strict":h+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid");}}return h}/**
 * Try decoding a string using a decoding function.
 *
 * @param {string} str
 * @param {function} decode
 * @private
 */function tryDecode(a,b){try{return b(a)}catch(b){return a}}var cookie={parse:parse_1,serialize:serialize_1},CookieStorage_1=createCommonjsModule(function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();b.hasCookies=function(){var a=new g;try{a.setItem("__test","1");var b=a.getItem("__test");return a.removeItem("__test"),"1"===b}catch(a){return!1}};var e=function(a){return a&&a.__esModule?a:{default:a}}(cookie),f="lS_",g=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};c(this,a),this.cookieOptions=Object.assign({path:"/"},b),f=void 0===b.prefix?f:b.prefix}return d(a,[{key:"getItem",value:function(a){var b=e.default.parse(document.cookie);return b&&b.hasOwnProperty(f+a)?b[f+a]:null}},{key:"setItem",value:function(a,b){return document.cookie=e.default.serialize(f+a,b,this.cookieOptions),b}},{key:"removeItem",value:function(a){var b=Object.assign({},this.cookieOptions,{maxAge:-1});return document.cookie=e.default.serialize(f+a,"",b),null}},{key:"clear",value:function(){var a=e.default.parse(document.cookie);for(var b in a)0===b.indexOf(f)&&this.removeItem(b.substr(f.length));return null}}]),a}();b.default=g});unwrapExports(CookieStorage_1);var CookieStorage_2=CookieStorage_1.hasCookies,isSupported_1=createCommonjsModule(function(a,b){function c(a){try{var b=window[a];return b.setItem("__test","1"),b.removeItem("__test"),!0}catch(a){return!1}}Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"localStorage",b=(a+"").replace(/storage$/i,"").toLowerCase();if("local"===b)return c("localStorage");if("session"===b)return c("sessionStorage");if("cookie"===b)return(0,CookieStorage_1.hasCookies)();if("memory"===b)return!0;throw new Error("Storage method `"+a+"` is not available.\n    Please use one of the following: localStorage, sessionStorage, cookieStorage, memoryStorage.")}});unwrapExports(isSupported_1);var MemoryStorage_1=createCommonjsModule(function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(){function a(){c(this,a),this._data={}}return d(a,[{key:"getItem",value:function(a){return this._data.hasOwnProperty(a)?this._data[a]:null}},{key:"setItem",value:function(a,b){return this._data[a]=b+""}},{key:"removeItem",value:function(a){return delete this._data[a]}},{key:"clear",value:function(){return this._data={}}}]),a}();b.default=e});unwrapExports(MemoryStorage_1);var lib=createCommonjsModule(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0}),b.MemoryStorage=b.CookieStorage=b.isSupported=b.storage=void 0;var d=c(isSupported_1),e=c(CookieStorage_1),f=c(MemoryStorage_1),g=null;b.storage=(0,d.default)("localStorage")?g=window.localStorage:(0,d.default)("sessionStorage")?g=window.sessionStorage:(0,d.default)("cookieStorage")?g=new e.default:g=new f.default,b.default=g,b.storage=g,b.isSupported=d.default,b.CookieStorage=e.default,b.MemoryStorage=f.default}),storage=unwrapExports(lib),lib_1=lib.MemoryStorage,lib_2=lib.CookieStorage,lib_3=lib.isSupported,lib_4=lib.storage;/*
 *  @license
 *    Copyright 2018 Brigham Young University
 *
 *    Licensed under the Apache License, Version 2.0 (the "License");
 *    you may not use this file except in compliance with the License.
 *    You may obtain a copy of the License at
 *
 *        http://www.apache.org/licenses/LICENSE-2.0
 *
 *    Unless required by applicable law or agreed to in writing, software
 *    distributed under the License is distributed on an "AS IS" BASIS,
 *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *    See the License for the specific language governing permissions and
 *    limitations under the License.
 */const cookie$1=new lib_2;class StorageHandler{saveOAuthState(a,b){cookie$1.setItem(getKey(a),JSON.stringify(b))}getOAuthState(a){const b=cookie$1.getItem(getKey(a));return b?JSON.parse(b):null}clearOAuthState(a){cookie$1.removeItem(getKey(a))}saveSessionState(a,b){storage.setItem(getSessionKey(a),JSON.stringify(b))}getSessionState(a){const b=getSessionKey(a),c=storage.getItem(b);return c?JSON.parse(c):null}clearSessionState(a){storage.removeItem(getSessionKey(a))}}function getKey(a){return"oauth-state-"+encodeURIComponent(a)}function getSessionKey(a){return getKey(a)+"-active-session"}var sha256=createCommonjsModule(function(module){/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */ /*jslint bitwise: true */(function(){function Sha256(a,b){b?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=a}function HmacSha256(a,c,d){var e,f=typeof a;if("string"==f){var g,h=[],j=a.length,k=0;for(e=0;e<j;++e)g=a.charCodeAt(e),128>g?h[k++]=g:2048>g?(h[k++]=192|g>>6,h[k++]=128|63&g):55296>g||57344<=g?(h[k++]=224|g>>12,h[k++]=128|63&g>>6,h[k++]=128|63&g):(g=65536+((1023&g)<<10|1023&a.charCodeAt(++e)),h[k++]=240|g>>18,h[k++]=128|63&g>>12,h[k++]=128|63&g>>6,h[k++]=128|63&g);a=h}else if("object"!=f)throw new Error("input is invalid type");else if(null===a)throw new Error("input is invalid type");else if(ARRAY_BUFFER&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!Array.isArray(a)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(a)))throw new Error("input is invalid type");64<a.length&&(a=new Sha256(c,!0).update(a).array());var l=[],m=[];for(e=0;64>e;++e){var n=a[e]||0;l[e]=92^n,m[e]=54^n}Sha256.call(this,c,d),this.update(m),this.oKeyPad=l,this.inner=!0,this.sharedMemory=d}var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&!0&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(a){return"object"==typeof a&&a.buffer&&a.buffer.constructor===ArrayBuffer});var createOutputMethod=function(a,b){return function(c){return new Sha256(b,!0).update(c)[a]()}},createMethod=function(a){var b=createOutputMethod("hex",a);NODE_JS&&(b=nodeWrap(b,a)),b.create=function(){return new Sha256(a)},b.update=function(a){return b.create().update(a)};for(var c,d=0;d<OUTPUT_TYPES.length;++d)c=OUTPUT_TYPES[d],b[c]=createOutputMethod(c,a);return b},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(a){if("string"==typeof a)return crypto.createHash(algorithm).update(a,"utf8").digest("hex");if(null===a||void 0===a)throw new Error("input is invalid type");else a.constructor===ArrayBuffer&&(a=new Uint8Array(a));return Array.isArray(a)||ArrayBuffer.isView(a)||a.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(a)).digest("hex"):method(a)};return nodeMethod},createHmacOutputMethod=function(a,b){return function(c,d){return new HmacSha256(c,b,!0).update(d)[a]()}},createHmacMethod=function(a){var b=createHmacOutputMethod("hex",a);b.create=function(b){return new HmacSha256(b,a)},b.update=function(a,c){return b.create(a).update(c)};for(var c,d=0;d<OUTPUT_TYPES.length;++d)c=OUTPUT_TYPES[d],b[c]=createHmacOutputMethod(c,a);return b};Sha256.prototype.update=function(a){if(!this.finalized){var b,c=typeof a;if("string"!=c){if("object"!=c)throw new Error("input is invalid type");else if(null===a)throw new Error("input is invalid type");else if(ARRAY_BUFFER&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!Array.isArray(a)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(a)))throw new Error("input is invalid type");b=!0}for(var d,e,f=0,g=a.length,h=this.blocks;f<g;){if(this.hashed&&(this.hashed=!1,h[0]=this.block,h[16]=h[1]=h[2]=h[3]=h[4]=h[5]=h[6]=h[7]=h[8]=h[9]=h[10]=h[11]=h[12]=h[13]=h[14]=h[15]=0),b)for(e=this.start;f<g&&64>e;++f)h[e>>2]|=a[f]<<SHIFT[3&e++];else for(e=this.start;f<g&&64>e;++f)d=a.charCodeAt(f),128>d?h[e>>2]|=d<<SHIFT[3&e++]:2048>d?(h[e>>2]|=(192|d>>6)<<SHIFT[3&e++],h[e>>2]|=(128|63&d)<<SHIFT[3&e++]):55296>d||57344<=d?(h[e>>2]|=(224|d>>12)<<SHIFT[3&e++],h[e>>2]|=(128|63&d>>6)<<SHIFT[3&e++],h[e>>2]|=(128|63&d)<<SHIFT[3&e++]):(d=65536+((1023&d)<<10|1023&a.charCodeAt(++f)),h[e>>2]|=(240|d>>18)<<SHIFT[3&e++],h[e>>2]|=(128|63&d>>12)<<SHIFT[3&e++],h[e>>2]|=(128|63&d>>6)<<SHIFT[3&e++],h[e>>2]|=(128|63&d)<<SHIFT[3&e++]);this.lastByteIndex=e,this.bytes+=e-this.start,64<=e?(this.block=h[16],this.start=e-64,this.hash(),this.hashed=!0):this.start=e}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes%=4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,b=this.lastByteIndex;a[16]=this.block,a[b>>2]|=EXTRA[3&b],this.block=a[16],56<=b&&(!this.hashed&&this.hash(),a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),a[14]=this.hBytes<<3|this.bytes>>>29,a[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var i,k,l,m,n,o,p,q,r,s,t,u=this.h0,v=this.h1,w=this.h2,x=this.h3,y=this.h4,z=this.h5,A=this.h6,B=this.h7,C=this.blocks;for(i=16;64>i;++i)// rightrotate
n=C[i-15],k=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,n=C[i-2],l=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,C[i]=C[i-16]+k+C[i-7]+l<<0;for(t=v&w,i=0;64>i;i+=4)this.first?(this.is224?(q=300032,n=C[0]-1413257819,B=n-150054599<<0,x=n+24177077<<0):(q=704751109,n=C[0]-210244248,B=n-1521486534<<0,x=n+143694565<<0),this.first=!1):(k=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),l=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),q=u&v,m=q^u&w^t,p=y&z^~y&A,n=B+l+p+K[i]+C[i],o=k+m,B=x+n<<0,x=n+o<<0),k=(x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>22|x<<10),l=(B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7),r=x&u,m=r^x&v^q,p=B&y^~B&z,n=A+l+p+K[i+1]+C[i+1],o=k+m,A=w+n<<0,w=n+o<<0,k=(w>>>2|w<<30)^(w>>>13|w<<19)^(w>>>22|w<<10),l=(A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7),s=w&x,m=s^w&u^r,p=A&B^~A&y,n=z+l+p+K[i+2]+C[i+2],o=k+m,z=v+n<<0,v=n+o<<0,k=(v>>>2|v<<30)^(v>>>13|v<<19)^(v>>>22|v<<10),l=(z>>>6|z<<26)^(z>>>11|z<<21)^(z>>>25|z<<7),t=v&w,m=t^v&x^s,p=z&A^~z&B,n=y+l+p+K[i+3]+C[i+3],o=k+m,y=u+n<<0,u=n+o<<0;this.h0=this.h0+u<<0,this.h1=this.h1+v<<0,this.h2=this.h2+w<<0,this.h3=this.h3+x<<0,this.h4=this.h4+y<<0,this.h5=this.h5+z<<0,this.h6=this.h6+A<<0,this.h7=this.h7+B<<0},Sha256.prototype.hex=function(){this.finalize();var a=this.h0,b=this.h1,c=this.h2,d=this.h3,e=this.h4,f=this.h5,g=this.h6,h=this.h7,i=HEX_CHARS[15&a>>28]+HEX_CHARS[15&a>>24]+HEX_CHARS[15&a>>20]+HEX_CHARS[15&a>>16]+HEX_CHARS[15&a>>12]+HEX_CHARS[15&a>>8]+HEX_CHARS[15&a>>4]+HEX_CHARS[15&a]+HEX_CHARS[15&b>>28]+HEX_CHARS[15&b>>24]+HEX_CHARS[15&b>>20]+HEX_CHARS[15&b>>16]+HEX_CHARS[15&b>>12]+HEX_CHARS[15&b>>8]+HEX_CHARS[15&b>>4]+HEX_CHARS[15&b]+HEX_CHARS[15&c>>28]+HEX_CHARS[15&c>>24]+HEX_CHARS[15&c>>20]+HEX_CHARS[15&c>>16]+HEX_CHARS[15&c>>12]+HEX_CHARS[15&c>>8]+HEX_CHARS[15&c>>4]+HEX_CHARS[15&c]+HEX_CHARS[15&d>>28]+HEX_CHARS[15&d>>24]+HEX_CHARS[15&d>>20]+HEX_CHARS[15&d>>16]+HEX_CHARS[15&d>>12]+HEX_CHARS[15&d>>8]+HEX_CHARS[15&d>>4]+HEX_CHARS[15&d]+HEX_CHARS[15&e>>28]+HEX_CHARS[15&e>>24]+HEX_CHARS[15&e>>20]+HEX_CHARS[15&e>>16]+HEX_CHARS[15&e>>12]+HEX_CHARS[15&e>>8]+HEX_CHARS[15&e>>4]+HEX_CHARS[15&e]+HEX_CHARS[15&f>>28]+HEX_CHARS[15&f>>24]+HEX_CHARS[15&f>>20]+HEX_CHARS[15&f>>16]+HEX_CHARS[15&f>>12]+HEX_CHARS[15&f>>8]+HEX_CHARS[15&f>>4]+HEX_CHARS[15&f]+HEX_CHARS[15&g>>28]+HEX_CHARS[15&g>>24]+HEX_CHARS[15&g>>20]+HEX_CHARS[15&g>>16]+HEX_CHARS[15&g>>12]+HEX_CHARS[15&g>>8]+HEX_CHARS[15&g>>4]+HEX_CHARS[15&g];return this.is224||(i+=HEX_CHARS[15&h>>28]+HEX_CHARS[15&h>>24]+HEX_CHARS[15&h>>20]+HEX_CHARS[15&h>>16]+HEX_CHARS[15&h>>12]+HEX_CHARS[15&h>>8]+HEX_CHARS[15&h>>4]+HEX_CHARS[15&h]),i},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var a=this.h0,b=this.h1,c=this.h2,d=this.h3,e=this.h4,f=this.h5,g=this.h6,h=this.h7,i=[255&a>>24,255&a>>16,255&a>>8,255&a,255&b>>24,255&b>>16,255&b>>8,255&b,255&c>>24,255&c>>16,255&c>>8,255&c,255&d>>24,255&d>>16,255&d>>8,255&d,255&e>>24,255&e>>16,255&e>>8,255&e,255&f>>24,255&f>>16,255&f>>8,255&f,255&g>>24,255&g>>16,255&g>>8,255&g];return this.is224||i.push(255&h>>24,255&h>>16,255&h>>8,255&h),i},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(this.is224?28:32),b=new DataView(a);return b.setUint32(0,this.h0),b.setUint32(4,this.h1),b.setUint32(8,this.h2),b.setUint32(12,this.h3),b.setUint32(16,this.h4),b.setUint32(20,this.h5),b.setUint32(24,this.h6),this.is224||b.setUint32(28,this.h7),a},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var a=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(a),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()});/*
 *  @license
 *    Copyright 2018 Brigham Young University
 *
 *    Licensed under the Apache License, Version 2.0 (the "License");
 *    you may not use this file except in compliance with the License.
 *    You may obtain a copy of the License at
 *
 *        http://www.apache.org/licenses/LICENSE-2.0
 *
 *    Unless required by applicable law or agreed to in writing, software
 *    distributed under the License is distributed on an "AS IS" BASIS,
 *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *    See the License for the specific language governing permissions and
 *    limitations under the License.
 */const sha256$1=sha256.sha256;let SINGLETON_INSTANCE,BASE_URL;const CHILD_IFRAME_ID="byu-oauth-implicit-grant-refresh-iframe",STORED_STATE_LIFETIME=300000,EXPIRATION_BUFFER=305,IG_STATE_AUTO_REFRESH_FAILED="implicit-grant-auto-refresh-failed";class ImplicitGrantProvider{constructor(a,b,c,d=new StorageHandler){// strip trailing slash(es)
debug("initializing provider with config",a),this.config=a,this.window=b,this.document=c,this.storageHandler=d,this._listeners={},BASE_URL=this.config.baseUrl.replace(/\/+$/,""),this.store=Object.freeze({state:STATE_INDETERMINATE,user:null,token:null,error:null}),debug("initialized provider")}_changeState(a,b,c,d){logStateChange(a,b,c,d),this.store=Object.freeze({state:a,user:b,token:c,error:d}),_dispatchEvent(this,EVENT_STATE_CHANGE,this.store)}_checkPopupOpener(){try{const a=this.window.opener.location.origin;if(a===new URL(this.config.callbackUrl).origin)// Origins match
return this.window.opener}catch(a){// Failed to get window.opener.location.origin, so we must have been opened
// from a different origin.
// Fall through to the "return false" outside this try/catch block
}return!1}_checkIframeOpener(){try{const a=this.window.parent.document.getElementById(CHILD_IFRAME_ID);if(a&&a.contentWindow===this.window)return a}catch(a){// Failed to access window.parent info, so we must be in an iframe from a different
// origin.
// Fall through to the "return false" outside this try/catch block
}return!1}// Separate state change listener, because state change events
// might come from child iframe/popup window
handleStateChange({state:a,user:b,token:c,source:d}){debug("in handleStateChange",a);const e=this._checkPopupOpener();// If this is a popup
if(e)// We're inside a child re-authentication popup
return d?void 0:(debug("dispatching event to parent"),_dispatchEvent(e,EVENT_STATE_CHANGE,{state:a,token:c,user:b,source:"popup"}),void(a===STATE_AUTHENTICATED&&(info("closing self"),this.window.close())));const f=this._checkIframeOpener();// If we're inside a "refresh" iframe
return f?d?void 0:(debug("dispatching event to parent"),_dispatchEvent(this.window.parent,EVENT_STATE_CHANGE,{state:a,token:c,user:b,source:"iframe"}),void(a===STATE_AUTHENTICATED&&(info("removing child iframe"),f.parentNode.removeChild(f)))):void(this._maybeUpdateStoredSession(a,b,c),a===STATE_AUTHENTICATED&&this._checkExpired(c.expiresAt.getTime()))}async startup(){ensureOnlyInstance(this),info("starting up"),this.listen(),this._changeState(STATE_INDETERMINATE);const a=this._location;if(this.isAuthenticationCallback(a)){debug("handling authentication callback"),this._changeState(STATE_AUTHENTICATING);try{const{state:b,user:c,token:d,error:e}=await _handleAuthenticationCallback(this.config,a,this.storageHandler);this._changeState(b,c,d,e)}catch(a){error("OAuth Error",a),this._changeState(STATE_ERROR,void 0,void 0,a)}}else this.hasStoredSession()?(debug("Has stored session"),this._updateStateFromStorage()):(debug("no authentication present"),this._changeState(STATE_UNAUTHENTICATED));return this}_checkExpired(a){var b=this;const c=a-Date.now();return debug(`checking expiration time; expires in ${c} ms, ${new Date(a)}`),30000<c?(this.__expirationTask&&clearTimeout(this.__expirationTask),void(this.__expirationTask=setTimeout(function(){b.__expirationTask=null,b._checkExpired(a)},5e3))):void(this.config.autoRefreshOnTimeout?this.startRefresh("iframe"):this._changeState(STATE_EXPIRED,this.store.user,this.store.token))}get _location(){return this.window.location}isAuthenticationCallback(a){const b=0===a.href.indexOf(this.config.callbackUrl),c=a.search&&a.search.includes("code=")&&a.search.includes("state=");return!!(b&&c)}hasStoredSession(){return!!this.storageHandler.getSessionState(this.config.clientId)}shutdown(){info("shutting down"),this.unlisten(),this._changeState(STATE_INDETERMINATE),cleanupOnlyInstance()}listen(){debug("setting up event listeners"),_listenTo(this,EVENT_LOGIN_REQUESTED,this.startLogin),_listenTo(this,EVENT_LOGOUT_REQUESTED,this.startLogout),_listenTo(this,EVENT_REFRESH_REQUESTED,this.startRefresh),_listenTo(this,EVENT_CURRENT_INFO_REQUESTED,this.handleCurrentInfoRequest),_listenTo(this,EVENT_STATE_CHANGE,this.handleStateChange)}unlisten(){debug("tearing down event listeners"),_unlistenTo(this,EVENT_LOGIN_REQUESTED),_unlistenTo(this,EVENT_LOGOUT_REQUESTED),_unlistenTo(this,EVENT_REFRESH_REQUESTED),_unlistenTo(this,EVENT_CURRENT_INFO_REQUESTED),_unlistenTo(this,EVENT_STATE_CHANGE)}startLogin(a="window"){var b=String.fromCharCode,c=this;infof("Starting login. mode=%s",a);const{clientId:d,callbackUrl:e}=this.config,f=randomString(),g=randomString(128),h=btoa(b(...sha256$1.array(g))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),i=_prepareStoredState(Date.now()+STORED_STATE_LIFETIME,f,g,{});this.storageHandler.saveOAuthState(this.config.clientId,i);const j=`${BASE_URL}/authorize?response_type=code&client_id=${d}&redirect_uri=${encodeURIComponent(e)}&scope=openid&state=${f}&code_challenge=${h}&code_challenge_method=S256`;if(debug("computed login url of",j),!a||"window"==a)return info(`Redirecting user to '${j}'`),void(this.window.location=j);if("popup"===a)return info("launching popup at",j),void this.window.open(j);info("Setting up hidden refresh iframe at",j);// last option: displayType == 'iframe'
let k=this.document.getElementById(CHILD_IFRAME_ID);k&&k.parentNode.removeChild(k),k=this.document.createElement("iframe"),k.onload=function(){let a=null;try{a=k.contentWindow.document.body.innerHTML}catch(a){// intentional do-nothing
}null===a&&(k.parentNode.removeChild(k),c._changeState(IG_STATE_AUTO_REFRESH_FAILED,null,null),c._changeState(STATE_UNAUTHENTICATED,null,null))},k.id=CHILD_IFRAME_ID,k.src=j,k.style="display:none",debug("appending iframe",k),this.document.body.appendChild(k)}startLogout(){info("starting logout"),this.storageHandler.clearSessionState(this.config.clientId);// Need to ensure BOTH api.byu.edu and cas.byu.edu clean out their sessions
// With current config of those two sites, to have that full clean out AND a final "where to go after logout"
// redirect, we need to manually wrap them all together
const a=this.config.logoutRedirect===void 0?this.config.callbackUrl:this.config.logoutRedirect,b="https://cas.byu.edu/cas/logout?service="+encodeURIComponent(a),c=`${BASE_URL}/logout?redirect_url=`+encodeURIComponent(b);info("logging out by redirecting to",c),this.window.location=c}async startRefresh(a="iframe"){infof("starting refresh. displayType=%s",a);// Save copy of current info before triggering changeState
const b=Object.assign({},this.store.token),c=Object.assign({},this.store.user);if(this._changeState(STATE_REFRESHING,Object.assign({},this.store.user),Object.assign({},this.store.token)),"iframe"!==a)return void this.startLogin(a);// If we have a refresh token, then try that before doing the more complicated iframe version
if(!(b&&b.refresh))return void this.startLogin("iframe");const d=`${BASE_URL}/token`,e=new URLSearchParams;e.set("grant_type","refresh_token"),e.set("client_id",this.config.clientId),e.set("refresh_token",b.refresh);const f=await fetch(d,{method:"POST",headers:new Headers({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),body:e});if(200!==f.status)return void this.startLogin("iframe");const g=await f.json();b.bearer=g.access_token,b.refresh=g.refresh_token;const h=g.expires_in-EXPIRATION_BUFFER;b.authorizationHeader=`Bearer ${b.bearer}`,b.expiresAt=new Date(Date.now()+1e3*h),this._changeState(STATE_AUTHENTICATED,c,b)}handleCurrentInfoRequest({callback:a}){debug("got current info request"),a&&a(this.store)}_updateStateFromStorage(){debug("updating state from local storage");const a=this.storageHandler.getSessionState(this.config.clientId);if(!a)return debug("no stored state"),void this._changeState(STATE_UNAUTHENTICATED);const{user:b,token:c}=deserializeSessionState(a);b&&c?c.expiresAt>new Date?(debug("found an unexpired saved session"),this._changeState(STATE_AUTHENTICATED,b,c)):(debug("stored session was expired"),this._changeState(STATE_UNAUTHENTICATED)):(debug("no stored user or token"),this._changeState(STATE_UNAUTHENTICATED))}_maybeUpdateStoredSession(a,b,c){if(debugf("updating stored session: state=%s hasUser=%s, hasToken=%s",a,!!b,!!c),a===STATE_UNAUTHENTICATED||a===STATE_REFRESHING||a===STATE_EXPIRED)debug("state is unauthenticated or expired, clearing stored session"),this.storageHandler.clearSessionState(this.config.clientId);else if(!!b&&!!c){debug("storing session",redactUser(b),redactToken(c));const a=serializeSessionState(b,c);this.storageHandler.saveSessionState(this.config.clientId,a)}}}function serializeSessionState(a,b){const c=groupClaimPrefixes(b.rawUserInfo),d={ro:c[CLAIMS_PREFIX_RESOURCE_OWNER],cl:c[CLAIMS_PREFIX_CLIENT],wso2:c[CLAIMS_PREFIX_WSO2],o:c.other};return{ui:d,at:b.bearer,rf:b.refresh,ah:b.authorizationHeader,ea:b.expiresAt.getTime()}}function deserializeSessionState(a){const b={[CLAIMS_PREFIX_RESOURCE_OWNER]:a.ui.ro,[CLAIMS_PREFIX_CLIENT]:a.ui.cl,[CLAIMS_PREFIX_WSO2]:a.ui.wso2,other:a.ui.o},c=ungroupClaimPrefixes(b),d=_processUserInfo(c),e=new Date(a.ea),f=_processTokenInfo({userInfo:c,accessToken:a.at,expiresAt:e,authHeader:`Bearer ${a.at}`,refreshToken:a.rf});return{user:d,token:f}}function _listenTo(a,b,c){if(a._listeners.hasOwnProperty(b))throw new Error("A listener is already registered for "+b);const d=a._listeners[b]=function(b){c.call(a,b.detail)}.bind(a);a.document.addEventListener(b,d,!1)}function _unlistenTo(a,b){a._listeners.hasOwnProperty(b)&&(a.document.removeEventListener(b,a._listeners[b],!1),delete a._listeners[b])}function _dispatchEvent(a,b,c){let d;"function"==typeof a.window.CustomEvent?d=new CustomEvent(b,{detail:c}):(d=a.document.createEvent("CustomEvent"),d.initCustomEvent(b,!0,!1,c)),a.document.dispatchEvent(d)}async function _handleAuthenticationCallback(a,b,c){const d=new URLSearchParams(b.search),e=d.get("state"),f=c.getOAuthState(a.clientId);c.clearOAuthState(a.clientId),debug("checking oauth state token");const g=_validateAndGetStoredState(f,e),h=await _fetchTokenInfo(d.get("code"),a,f.v),i=h.access_token,j=h.refresh_token,k=h.expires_in-EXPIRATION_BUFFER,l=new Date(Date.now()+1e3*k),m=`Bearer ${i}`;debug("got token",redactBearerToken(i),"which expires in",k,"seconds");const n=await _fetchUserInfo(m),o=_processUserInfo(n),p=_processTokenInfo({userInfo:n,accessToken:i,expiresAt:l,authHeader:m,refreshToken:j});return{state:STATE_AUTHENTICATED,user:o,token:p}}async function _fetchTokenInfo(a,b,c){debug("Exchanging code for token");const d=`${BASE_URL}/token`,e=new URLSearchParams;e.set("grant_type","authorization_code"),e.set("client_id",b.clientId),e.set("redirect_uri",b.callbackUrl),e.set("code",a),e.set("code_verifier",c);const f=await fetch(d,{method:"POST",headers:new Headers({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),body:e});if(200!==f.status){const a=await f.text();throw error("Error getting OAuth User Info. Status Code:",f.status,"Response:\n",a),new OAuthError("unable-to-exchange-code-for-token","Unable to exchange code for token. Please try again.")}const g=await f.json();return debug("successfully got user info",g),g}async function _fetchUserInfo(a){const b=`${BASE_URL}/openid-userinfo/v1/userinfo?schema=openid`;debug("fetching user info from",b);const c=await fetch(b,{method:"GET",headers:new Headers({Accept:"application/json",Authorization:a}),mode:"cors"});if(debug("got status",c.status),200!==c.status){const a=await c.text();if(403===c.status)if(debug("got forbidden error"),a.includes("<ams:code>900908</ams:code>"))throw debug("client app isn't subscribed to OpenID UserInfo endpoint"),error(`DEVELOPER ERROR: You may not be subscribed to the OpenID UserInfo endpoint. Please visit https://api.byu.edu/store/apis/info?name=OpenID-Userinfo&version=v1&provider=BYU%2Fjmooreoa to subscribe.`),new OAuthError("not-subscribed-to-user-info","This page has an authentication configuration error. Developers, see the console for details.");else throw error("invalid oauth bearer token"),new OAuthError("invalid-oauth-token","The provided authentication token is invalid. Please try again.");throw error("Error getting OAuth User Info. Status Code:",c.status,"Response:\n",a),new OAuthError("unable-to-get-user-info","Unable to fetch user information. Please try again.")}const d=await c.json();return debug("successfully got user info",d),d}const CLAIMS_PREFIX_RESOURCE_OWNER="http://byu.edu/claims/resourceowner_",CLAIMS_PREFIX_CLIENT="http://byu.edu/claims/client_",CLAIMS_PREFIX_WSO2="http://wso2.org/claims/",CLAIMS_KNOWN_PREFIXES=[CLAIMS_PREFIX_CLIENT,"http://byu.edu/claims/resourceowner_",CLAIMS_PREFIX_WSO2];function groupClaimPrefixes(a){const b={other:{}};for(const c of CLAIMS_KNOWN_PREFIXES)b[c]={};for(const c of Object.keys(a)){const d=a[c],e=CLAIMS_KNOWN_PREFIXES.find(function(a){return c.startsWith(a)});e?b[e][c.substr(e.length)]=d:b.other[c]=d}return b}function ungroupClaimPrefixes(a){const b={};for(const c of CLAIMS_KNOWN_PREFIXES){const d=a[c];if(d)for(const a of Object.keys(d))b[c+a]=d[a]}for(const c of Object.keys(a.other))b[c]=a.other[c];return b}function getClaims(a,b){return Object.keys(a).filter(function(a){return a.startsWith(b)}).reduce(function(c,d){return c[d.substr(b.length)]=a[d],c},{})}function _processUserInfo(a){const b=getClaims(a,CLAIMS_PREFIX_RESOURCE_OWNER),c=b.surname_position,d=b.preferred_first_name,e=b.surname,f="F"===c?`${e} ${d}`:`${d} ${e}`;return{personId:b.person_id,byuId:b.byu_id,netId:b.net_id,name:{sortName:b.sort_name,displayName:f,givenName:d,familyName:e,familyNamePosition:c},rawUserInfo:a}}function _processTokenInfo({userInfo:a,accessToken:b,expiresAt:c,authHeader:d,refreshToken:e}){const f=getClaims(a,CLAIMS_PREFIX_CLIENT),g=getClaims(a,CLAIMS_PREFIX_WSO2);return{bearer:b,refresh:e,authorizationHeader:d,expiresAt:c,client:{id:g.client_id,byuId:f.byu_id,appName:g.applicationname},rawUserInfo:a}}function _validateAndGetStoredState(a,b){if(debug("validating stored state token. Expecting token",b,", got state",a),!a)throw error("no stored oauth login state"),new OAuthError("no-oauth-state","Your saved authentication information does not match. Please try again.");const{e:c,c:d,s:e}=a;if(b!==d)throw error("CSRF token mismatch"),new OAuthError("oauth-state-mismatch","Your saved authentication information does not match. Please try again.");if(+c<Date.now())throw error("stored state has expired"),new OAuthError("oauth-state-expired","Your login attempt has timed out. Please try again.");return e}function _prepareStoredState(a,b,c,d){return{e:a,c:b,v:c,s:d}}class OAuthError extends Error{constructor(a,b,c){super("OAuth Error: "+b),this.type=a,this.description=b,this.uri=c}}const allowableRandomChars=[..."0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"],randomCharRangeConvert=allowableRandomChars.length/256;// Using Uint8Array for getRandomValues
function randomString(a){var b=Math.floor;const c=new Uint8Array(a||24),d=window.crypto||window.msCrypto;return d.getRandomValues(c),c.reduce(function(a,c){return a+allowableRandomChars[b(c*randomCharRangeConvert)]},"")}function logStateChange(a,b,c,d){const e=["state change:",{state:a,user:redactUser(b),token:c,//redactToken(token),
error:d}];d?error(...e):info(...e)}function redactUser(a){return a?{netId:a.netId,"rest-is-redacted":!0}:void 0}function redactToken(a){if(debug("redacting token",a),!!a){const{bearer:b,expiresAt:c,client:d}=a;return{bearer:redactBearerToken(b),expiresAt:c?c.toISOString():null,client:d,"rest-is-redacted":!0}}}function redactBearerToken(a){return a?a.substring(0,2)+"...redacted..."+a.substring(a.length-2):void 0}function ensureOnlyInstance(a){if(SINGLETON_INSTANCE){const a=SINGLETON_INSTANCE.___startupTrace;throw new Error("There is already an instance of byu-oauth-implicit running!  Please call `#shutdown()` on that instance before starting a new one. Instance was started at:\n"+a)}a.___startupTrace=new Error().stack,SINGLETON_INSTANCE=a}function cleanupOnlyInstance(){SINGLETON_INSTANCE=null}/*
 * Copyright 2018 Brigham Young University
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ISSUER="https://api.byu.edu",DEFAULT_BASE_URL="https://api.byu.edu",GLOBAL_CONFIG_KEY="byu-oauth-implicit-config";/**
 * @typedef {} ImplicitConfig
 * @prop {string} clientId
 * @prop {?string} issuer
 * @prop {?string} baseUrl
 * @prop {?string} callbackUrl
 * @prop {?boolean} requireAuthentication
 */ /**
 * @param {ImplicitConfig|ImplicitConfig[]|undefined} cfgOrRules
 * @param location
 */async function configure(a,b=window.location){const c=resolveConfig(a,b),d=window[GLOBAL_CONFIG_KEY],e=Object.assign({issuer:DEFAULT_ISSUER,baseUrl:DEFAULT_BASE_URL,callbackUrl:`${b.origin}${b.pathname}`,autoRefreshOnTimeout:!1},d,c);if(!e.clientId)throw new Error("clientId must be specified in config");const f=new ImplicitGrantProvider(e,window,document);return f.startup()}function resolveConfig(a,b){if(!a)return{};if("clientId"in a)return a;const c=Object.keys(a).filter(function(a){return a.startsWith("https://")||a.startsWith("http://")});if(0===c.length)return a;const d=c// order by length of key (most specific), descending
.sort(function(c,a){return a.length-c.length}).find(function(a){return b.href.startsWith(a)});if(d)return Object.assign({callbackUrl:d},a[d]);throw new Error(`Unable to match url [${b.href}] to one of [${c}]`)}export{DEFAULT_BASE_URL,DEFAULT_ISSUER,GLOBAL_CONFIG_KEY,IG_STATE_AUTO_REFRESH_FAILED,configure};
//# sourceMappingURL=implicit-grant.min.js.map
